<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mes fichiers - CloudDrive</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">CloudDrive</div>
        <div class="user-menu">
            <div class="user-info">
                <div class="avatar" id="userAvatar">JD</div>
                <div>
                    <div id="userName">Tendry</div>
                    <div class="storage-text">
                        <span id="usedStorage">700 Mo</span> / 
                        <span id="totalStorage">1 Go</span>
                    </div>
                </div>
                <div class="storage-bar" style="--progress: 70%"></div>
            </div>
            <button class="btn btn-secondary" onclick="showUploadModal()">
                <i class="fas fa-upload"></i> Téléverser
            </button>
            <button class="btn btn-secondary" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Déconnexion
            </button>
        </div>
    </header>

    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="nav-section">
                <div class="nav-title">Navigation</div>
                <a href="index.html" class="nav-item active">
                    <i class="fas fa-folder"></i> Mes fichiers
                </a>
                <a href="shared.html" class="nav-item">
                    <i class="fas fa-share-alt"></i> Fichiers partagés
                </a>
                <a href="#" class="nav-item" onclick="showComingSoon()">
                    <i class="fas fa-clock"></i> Récents
                </a>
                <a href="#" class="nav-item" onclick="showComingSoon()">
                    <i class="fas fa-trash"></i> Corbeille
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">Dossiers</div>
                <a href="#" class="nav-item" onclick="filterFiles('documents')">
                    <i class="fas fa-file-pdf"></i> Documents
                </a>
                <a href="#" class="nav-item" onclick="filterFiles('images')">
                    <i class="fas fa-image"></i> Images
                </a>
                <a href="#" class="nav-item" onclick="filterFiles('videos')">
                    <i class="fas fa-video"></i> Vidéos
                </a>
                <button class="nav-item" onclick="showCreateFolderModal()">
                    <i class="fas fa-folder-plus"></i> Nouveau dossier
                </button>
            </div>

            <div class="nav-section">
                <div class="nav-title">Actions rapides</div>
                <button class="nav-item" onclick="toggleView()">
                    <i class="fas fa-th-large"></i> Changer vue
                </button>
                <button class="nav-item" onclick="selectAll()">
                    <i class="fas fa-check-square"></i> Tout sélectionner
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <h1>Mes fichiers</h1>
                <div class="actions">
                    <input type="text" class="form-input" placeholder="Rechercher un fichier..." 
                           style="width: 300px;" id="searchInput" oninput="searchFiles()">
                    <button class="btn btn-primary" onclick="showUploadModal()">
                        <i class="fas fa-cloud-upload-alt"></i>Nouveau téléversement
                    </button>
                </div>
            </div>

            <!-- Drop Zone -->
            <div class="drop-zone" id="dropZone" ondragover="handleDragOver(event)" 
                 ondragleave="handleDragLeave(event)" ondrop="handleDrop(event)">
                <div class="drop-zone-content">
                    <div class="drop-zone-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <div class="drop-zone-text">
                        Déposez vos fichiers ici
                    </div>
                    <div class="drop-zone-hint">
                        ou cliquez pour parcourir
                    </div>
                </div>
            </div>

            <!-- Files Grid View -->
            <div class="files-grid" id="filesGrid">
                <!-- Files will be loaded here -->
            </div>

            <!-- Files List View (hidden by default) -->
            <div class="files-list" id="filesList" style="display: none;">
                <div class="file-row file-row-header">
                    <div><i class="fas fa-check"></i></div>
                    <div>Nom</div>
                    <div>Taille</div>
                    <div>Type</div>
                    <div>Modifié</div>
                    <div>Actions</div>
                </div>
                <!-- Files will be loaded here -->
            </div>

            <!-- Empty State -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <div class="empty-state-icon">
                    <i class="fas fa-folder-open"></i>
                </div>
                <div class="empty-state-title">Aucun fichier</div>
                <div class="empty-state-description">
                    Commencez par uploader vos premiers fichiers
                </div>
                <button class="btn btn-primary" style="margin-top: 1.5rem;" onclick="showUploadModal()">
                    <i class="fas fa-upload"></i> Uploader un fichier
                </button>
            </div>
        </main>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Téléverser mes fichiers</div>
                <button class="close-modal" onclick="closeModal('uploadModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Sélectionnez des fichiers</label>
                    <input type="file" class="form-input" id="fileInput" multiple>
                </div>
                <div class="upload-progress" style="--progress: 0%" id="uploadProgress"></div>
                <div id="uploadStatus"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('uploadModal')">Annuler</button>
                <button class="btn btn-primary" onclick="uploadFiles()">téléverser</button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Partager un fichier</div>
                <button class="close-modal" onclick="closeModal('shareModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Fichier à partager</label>
                    <input type="text" class="form-input" id="shareFileName" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">Partager avec (email)</label>
                    <input type="email" class="form-input" id="shareEmail" 
                           placeholder="Laissez vide pour partage public">
                </div>
                <div class="form-group">
                    <label class="form-label">Permissions</label>
                    <select class="form-input" id="sharePermissions">
                        <option value="view">Lecture seule</option>
                        <option value="edit">Lecture et écriture</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Expiration (optionnel)</label>
                    <input type="datetime-local" class="form-input" id="shareExpires">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('shareModal')">Annuler</button>
                <button class="btn btn-primary" onclick="createShare()">Partager</button>
            </div>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/api.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html>